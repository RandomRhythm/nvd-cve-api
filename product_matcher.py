
class ProductMatcher:
    def __init__(self, product_file) -> None:
        with open(product_file, 'r') as f:
            self.products = list(set(map(str.strip, f.readlines())))
            
    def is_match(self, cve):
        desc_lower = [_ for _ in cve.description.lower().split(' ') if len(_) > 1]
        for product in self.products:
            uniq_word = list(map(str.lower, set(product.split(' '))))
            if set(uniq_word).issubset(set(desc_lower)):
                return True, product
        else:
            return False, None