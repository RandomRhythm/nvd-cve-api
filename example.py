import nvd
from product_matcher import ProductMatcher
from simple_cve import SimpleCVE

api = nvd.NVD()
cves = api.get_cves(20000)
matcher = ProductMatcher('products.txt')

for cve in cves:
    scve = SimpleCVE(cve)
    # print(scve.cve_id)
    match_result, matched_product = matcher.is_match(scve)
    if match_result:
        print('--->', scve.cve_id, matched_product)